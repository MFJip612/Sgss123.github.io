var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},MapLoggingEventID,CovidMap;(function(n){n.Loaded="Covid_Map_Loaded";n.PushPinAdded="Covid_Map_Pushpins_Loaded";n.PushPinClicked="Covid_Map_Pushpin_Clicked";n.ZoomIn="Covid_Map_Zoom_In";n.ZoomOut="Cvoid_Map_Zoom_Out";n.Move="Covid_Map_Pan"})(MapLoggingEventID||(MapLoggingEventID={})),function(n){function ot(t){n.mapOptions&&!n.mapOptions.icmp&&(n.map=new Microsoft.Maps.Map("#".concat(t),{credentials:n.mapOptions.cred,center:new Microsoft.Maps.Location(n.mapOptions.lat,n.mapOptions.lon),zoom:n.mapOptions.zoom,mapTypeId:Microsoft.Maps.MapTypeId.grayscale,showMapTypeSelector:!1,showLogo:!1,showTermsLink:!1,showZoomButtons:!0,showTrafficButton:!1,showLocateMeButton:!1,showScalebar:!1,liteMode:!0,disableStreetside:!0,navigationBarMode:Microsoft.Maps.NavigationBarMode.square,navigationBarOrientation:Microsoft.Maps.NavigationBarOrientation.vertical,serpMultiMapsAccessible:!!document.querySelector("#v8Map")}));b()}function b(){n.map&&n.map.entities&&(yt(),k())}function k(){var n=document.querySelector(".map-cntr"),t=document.querySelector(".loading-cntr");n&&Lib.CssClass.remove(n,"b_hide");t&&Lib.CssClass.add(t,"b_hide");w=document.querySelector(".ll-ovl-wrp a");i("Load",MapLoggingEventID.Loaded)}function st(){t&&(Lib.CssClass.add(t,"b_hide"),u.setOptions({icon:s(u.metadata.cr,!1)}))}function ht(){n.mapOptions.ttp&&!n.mapOptions.fttp?y=gt():n.mapOptions.ttp&&(t=document.querySelector(".cvid .fttp-ovl-wrp"),t&&(e=t.querySelector(".p-ttl"),r=t.querySelectorAll(".p-dtl-wrp .cnt")));f=n.map.getZoom();a=n.map.getPageX();v=n.map.getPageY();o&&setTimeout(function(){return d(o)},50);ct()}function ct(){Microsoft.Maps.Events.addThrottledHandler(n.map,"viewchangeend",at,500);n.pinInfoBox&&Microsoft.Maps.Events.addHandler(n.map,"click",lt)}function lt(t){t.targetType!=="pushpin"&&n.pinInfoBox.setOptions({visible:!1})}function at(){var t=n.map.getZoom();return t>f?i("Dims",MapLoggingEventID.ZoomIn):t<f?i("Dims",MapLoggingEventID.ZoomOut):n.map.getPageX()!==a||n.map.getPageY()!==v?i("Click",MapLoggingEventID.Move):void 0}function i(t,i){if(n.mapOptions.inst&&typeof Log!="undefined")Covid.Root.Logger.logModuleEvent(t,"Map",i,{})}function s(n,t){var i=n*2+l;return'<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(i,'" height="').concat(i,'"><circle cx="').concat(i/2,'" cy="').concat(i/2,'" r="').concat(n,'" fill="').concat(tt,'" stroke="').concat(t?rt:it,'" stroke-width="').concat(t?l:ut,'"/><\/svg>')}function vt(n,t){var i=s(t,!1);return new Microsoft.Maps.Pushpin(n,{icon:i,anchor:new Microsoft.Maps.Point(t,t)})}function yt(){var t,e,s,r,y,p,w,b,l,a,u,k,d,nt,tt,f,v,it,rt,ut;if(n.pinLocations){for(e=[],n.mapOptions.ircd&&(w=g(n.pinLocations[0]),b=g(n.pinLocations[n.pinLocations.length-1]),y=c(w),p=c(b)),n.mapOptions.ttp&&!n.mapOptions.fttp&&(n.pinInfoBox=new Microsoft.Maps.Infobox(n.map.getCenter(),{visible:!1,showPointer:!1,showCloseButton:!1}),n.pinInfoBox.setMap(n.map)),f=0,v=n.pinLocations;f<v.length;f++)it=v[f],rt=it.split("|"),t=__spreadArray([],rt,!0),l=t[0],a=t[1],u=t[2],k=t[3],d=t[4],nt=t[5],tt=t[6],ut=new Microsoft.Maps.Location(+l,+a),s=n.mapOptions.ircd?bt(c(+u),y,p,ft,et):dt(+u),r=vt(ut,s),n.mapOptions.ttp&&(r.metadata={pl:nt,cc:h(+u),dc:h(+d),rc:h(+k),cr:s,cn:tt},+l==n.mapOptions.slat&&+a==n.mapOptions.slon&&(o=r),Microsoft.Maps.Events.addHandler(r,"click",wt)),e.push(r);n.map.entities.push(e);ht();i("Load",MapLoggingEventID.Loaded)}}function d(n){if(n&&n.metadata&&t){var i=n.metadata;e&&(e.innerHTML=i.pl);r&&(r[0].innerHTML=i.cc,r[1].innerHTML=i.rc,r[2].innerHTML=i.dc);Lib.CssClass.remove(t,"b_hide");u&&u.setOptions({icon:p});u=n;p=n.getIcon();n.setOptions({icon:s(i.cr,!0)});pt(n.metadata)}}function pt(t){if(n.mapOptions.lml&&t&&t.pl&&t.cn){var i=t.pl.replace(/\s/g,"").toLowerCase(),r=t.cn.replace(/\s/g,"").toLowerCase(),u=encodeURI(i===r?"".concat(i):"".concat(i,"_").concat(r)),f=nt(n.mapOptions.lml,[u,n.mapOptions.fc]);w.setAttribute("href",f)}}function wt(t){var r,u;if(t){if(r=t instanceof Microsoft.Maps.Pushpin?t:t.target,n.pinInfoBox){if(u=r.metadata,!u)return;n.pinInfoBox.setOptions({location:t.location,htmlContent:kt(u),visible:!0})}else d(r);i("Click",MapLoggingEventID.PushPinClicked)}}function h(t){return t>=0?t.toLocaleString(n.mapOptions.mkt):"-"}function bt(n,t,i,r,u){var f=(n-t)/(i-t);return f*(u-r)+r}function c(n){return Math.ceil(Math.sqrt(n))}function g(n){return+n.split("|")[2]}function kt(n){return nt(y,[n.pl,n.cc,n.rc,n.dc])}function nt(n,t){var i=t;return n.replace(/{(\d+)}/g,function(n,t){return i[t]?i[t]:n})}function dt(n){if(n<=0)return 0;switch(!0){case n<=10:return 5;case n<=25:return 10;case n<=100:return 14;case n<=250:return 18;case n<=500:return 20;case n<=1e3:return 22;case n<=5e3:return 24;case n<=1e4:return 28;case n<=25e3:return 32;case n<=5e4:return 37;default:return 42}}function gt(){return'\n        <div class="p-box">\n            <div class="ttp top">\n                <div class="p-content">\n                    <div class="p-ttl-wrp">\n                        <span class="p-ttl">{0}<\/span>\n                        <span class="p-close" onclick="javascript:CovidMap.pinInfoBox.setOptions({ visible: false });">'.concat('\n            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="12" height="12">\n                <path stroke="#767676" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" fill="none" d="M1 1l14 14M15 1l-14 14"><\/path>\n            <\/svg>\n        ','<\/span>\n                    <\/div>\n                    <div class="p-dtl-wrp">\n                        <div class="dtl-cnt">\n                            <span class="sp-crl cc"><\/span>\n                            <span class="cnt-wrp">\n                                <span>').concat(n.locStrings.cc,' <\/span><span class="cnt">{1}<\/span>\n                            <\/span>\n                        <\/div>\n                        <div class="dtl-cnt">\n                            <span class="sp-crl rc"><\/span>\n                            <span class="cnt-wrp">\n                                <span>').concat(n.locStrings.rc,'<\/span><span>{2}<\/span>\n                            <\/span>\n                        <\/div>\n                        <div class="dtl-cnt">\n                            <span class="sp-crl dc"><\/span>\n                            <span class="cnt-wrp">\n                                <span>').concat(n.locStrings.fc,"<\/span><span>{3}<\/span>\n                            <\/span>\n                        <\/div>\n                    <\/div>\n                <\/div>\n            <\/div>\n        <\/div>\n    ")}var tt="rgba(222, 55, 0, 0.5)",it="rgba(255, 255, 255, 0.5)",rt="rgba(222, 55, 0)",ut=1,l=4,ft=4,et=40,f,a,v,y,t,e,r,u,p,o,w;n.loadMap=ot;n.onMapLoaded=b;n.postInit=k;n.closeFixedTooltip=st;sj_evt.fire("OnScriptLoad:CovidMap.MapModule")}(CovidMap||(CovidMap={}))